{"ast":null,"code":"import copy from 'fast-copy';\nimport qs from 'qs';\nimport { platform, release } from 'os';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = o[Symbol.iterator]();\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nvar attempts = {};\nvar networkErrorAttempts = 0;\n\nfunction noop() {\n  return undefined;\n}\n\nvar delay = function delay(ms) {\n  return new Promise(function (resolve) {\n    setTimeout(resolve, ms);\n  });\n};\n\nfunction rateLimit(instance) {\n  var maxRetry = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n  var _instance$defaults = instance.defaults,\n      _instance$defaults$re = _instance$defaults.responseLogger,\n      responseLogger = _instance$defaults$re === void 0 ? noop : _instance$defaults$re,\n      _instance$defaults$re2 = _instance$defaults.requestLogger,\n      requestLogger = _instance$defaults$re2 === void 0 ? noop : _instance$defaults$re2;\n  instance.interceptors.request.use(function (config) {\n    requestLogger(config);\n    return config;\n  }, function (error) {\n    requestLogger(error);\n    return Promise.reject(error);\n  });\n  instance.interceptors.response.use(function (response) {\n    // we don't need to do anything here\n    responseLogger(response);\n    return response;\n  }, function (error) {\n    var response = error.response;\n    var config = error.config;\n    responseLogger(error); // Do not retry if it is disabled or no request config exists (not an axios error)\n\n    if (!config || !instance.defaults.retryOnError) {\n      return Promise.reject(error);\n    }\n\n    var retryErrorType = null;\n    var wait = 0; // Errors without response did not recieve anything from the server\n\n    if (!response) {\n      retryErrorType = 'Connection';\n      networkErrorAttempts++;\n\n      if (networkErrorAttempts > maxRetry) {\n        error.attempts = networkErrorAttempts;\n        return Promise.reject(error);\n      }\n\n      wait = Math.pow(Math.SQRT2, networkErrorAttempts);\n      response = {};\n    } else {\n      networkErrorAttempts = 0;\n    }\n\n    if (response.status >= 500 && response.status < 600) {\n      // 5** errors are server related\n      retryErrorType = \"Server \".concat(response.status);\n      var headers = response.headers || {};\n      var requestId = headers['x-contentful-request-id'] || null;\n      attempts[requestId] = attempts[requestId] || 0;\n      attempts[requestId]++; // we reject if there are too many errors with the same request id or request id is not defined\n\n      if (attempts[requestId] > maxRetry || !requestId) {\n        error.attempts = attempts[requestId];\n        return Promise.reject(error);\n      }\n\n      wait = Math.pow(Math.SQRT2, attempts[requestId]);\n    } else if (response.status === 429) {\n      // 429 errors are exceeded rate limit exceptions\n      retryErrorType = 'Rate limit'; // all headers are lowercased by axios https://github.com/mzabriskie/axios/issues/413\n\n      if (response.headers && error.response.headers['x-contentful-ratelimit-reset']) {\n        wait = response.headers['x-contentful-ratelimit-reset'];\n      }\n    }\n\n    if (retryErrorType) {\n      // convert to ms and add jitter\n      wait = Math.floor(wait * 1000 + Math.random() * 200 + 500);\n      instance.defaults.logHandler('warning', \"\".concat(retryErrorType, \" error occurred. Waiting for \").concat(wait, \" ms before retrying...\"));\n      /* Somehow between the interceptor and retrying the request the httpAgent/httpsAgent gets transformed from an Agent-like object\n       to a regular object, causing failures on retries after rate limits. Removing these properties here fixes the error, but retry\n       requests still use the original http/httpsAgent property */\n\n      delete config.httpAgent;\n      delete config.httpsAgent;\n      return delay(wait).then(function () {\n        return instance(config);\n      });\n    }\n\n    return Promise.reject(error);\n  });\n}\n\nfunction asyncToken(instance, getToken) {\n  instance.interceptors.request.use(function (config) {\n    return getToken().then(function (accessToken) {\n      config.headers = _objectSpread2(_objectSpread2({}, config.headers), {}, {\n        Authorization: \"Bearer \".concat(accessToken)\n      });\n      return config;\n    });\n  });\n}\n\nfunction isNode() {\n  /**\n   * Polyfills of 'process' might set process.browser === true\n   *\n   * See:\n   * https://github.com/webpack/node-libs-browser/blob/master/mock/process.js#L8\n   * https://github.com/defunctzombie/node-process/blob/master/browser.js#L156\n   **/\n  return typeof process !== 'undefined' && !process.browser;\n}\n\nfunction isReactNative() {\n  return typeof window !== 'undefined' && 'navigator' in window && 'product' in window.navigator && window.navigator.product === 'ReactNative';\n}\n\nfunction getNodeVersion() {\n  return process.versions && process.versions.node ? \"v\".concat(process.versions.node) : process.version;\n}\n\nfunction getWindow() {\n  return window;\n} // Also enforces toplevel domain specified, no spaces and no protocol\n\n\nvar HOST_REGEX = /^(?!\\w+:\\/\\/)([^\\s:]+\\.?[^\\s:]+)(?::(\\d+))?(?!:)$/;\n/**\n * Create pre configured axios instance\n * @private\n * @param {AxiosStatic} axios - Axios library\n * @param {CreateHttpClientParams} options - Initialization parameters for the HTTP client\n * @return {ContentfulAxiosInstance} Initialized axios instance\n */\n\nfunction createHttpClient(axios, options) {\n  var defaultConfig = {\n    insecure: false,\n    retryOnError: true,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    logHandler: function logHandler(level, data) {\n      if (level === 'error' && data) {\n        var title = [data.name, data.message].filter(function (a) {\n          return a;\n        }).join(' - ');\n        console.error(\"[error] \".concat(title));\n        console.error(data);\n        return;\n      }\n\n      console.log(\"[\".concat(level, \"] \").concat(data));\n    },\n    // Passed to axios\n    headers: {},\n    httpAgent: false,\n    httpsAgent: false,\n    timeout: 30000,\n    proxy: false,\n    basePath: '',\n    adapter: undefined,\n    maxContentLength: 1073741824 // 1GB\n\n  };\n\n  var config = _objectSpread2(_objectSpread2({}, defaultConfig), options);\n\n  if (!config.accessToken) {\n    var missingAccessTokenError = new TypeError('Expected parameter accessToken');\n    config.logHandler('error', missingAccessTokenError);\n    throw missingAccessTokenError;\n  } // Construct axios baseURL option\n\n\n  var protocol = config.insecure ? 'http' : 'https';\n  var space = config.space ? \"\".concat(config.space, \"/\") : '';\n  var hostname = config.defaultHostname;\n  var port = config.insecure ? 80 : 443;\n\n  if (config.host && HOST_REGEX.test(config.host)) {\n    var parsed = config.host.split(':');\n\n    if (parsed.length === 2) {\n      var _parsed = _slicedToArray(parsed, 2);\n\n      hostname = _parsed[0];\n      port = _parsed[1];\n    } else {\n      hostname = parsed[0];\n    }\n  } // Ensure that basePath does start but not end with a slash\n\n\n  if (config.basePath) {\n    config.basePath = \"/\".concat(config.basePath.split('/').filter(Boolean).join('/'));\n  }\n\n  var baseURL = options.baseURL || \"\".concat(protocol, \"://\").concat(hostname, \":\").concat(port).concat(config.basePath, \"/spaces/\").concat(space);\n\n  if (!config.headers.Authorization && typeof config.accessToken !== 'function') {\n    config.headers.Authorization = 'Bearer ' + config.accessToken;\n  } // Set these headers only for node because browsers don't like it when you\n  // override user-agent or accept-encoding.\n  // The SDKs should set their own X-Contentful-User-Agent.\n\n\n  if (isNode()) {\n    config.headers['user-agent'] = 'node.js/' + getNodeVersion();\n    config.headers['Accept-Encoding'] = 'gzip';\n  }\n\n  var axiosOptions = {\n    // Axios\n    baseURL: baseURL,\n    headers: config.headers,\n    httpAgent: config.httpAgent,\n    httpsAgent: config.httpsAgent,\n    paramsSerializer: qs.stringify,\n    proxy: config.proxy,\n    timeout: config.timeout,\n    adapter: config.adapter,\n    maxContentLength: config.maxContentLength,\n    // Contentful\n    logHandler: config.logHandler,\n    responseLogger: config.responseLogger,\n    requestLogger: config.requestLogger,\n    retryOnError: config.retryOnError\n  };\n  var instance = axios.create(axiosOptions);\n  instance.httpClientParams = options;\n  /**\n   * Creates a new axios instance with the same default base parameters as the\n   * current one, and with any overrides passed to the newParams object\n   * This is useful as the SDKs use dependency injection to get the axios library\n   * and the version of the library comes from different places depending\n   * on whether it's a browser build or a node.js build.\n   * @private\n   * @param {CreateHttpClientParams} httpClientParams - Initialization parameters for the HTTP client\n   * @return {ContentfulAxiosInstance} Initialized axios instance\n   */\n\n  instance.cloneWithNewParams = function (newParams) {\n    return createHttpClient(axios, _objectSpread2(_objectSpread2({}, copy(options)), newParams));\n  };\n  /**\n   * Apply interceptors.\n   * Please note that the order of interceptors is important\n   */\n\n\n  if (config.onBeforeRequest) {\n    instance.interceptors.request.use(config.onBeforeRequest);\n  }\n\n  if (typeof config.accessToken === 'function') {\n    asyncToken(instance, config.accessToken);\n  }\n\n  rateLimit(instance, config.retryLimit);\n\n  if (config.onError) {\n    instance.interceptors.response.use(function (response) {\n      return response;\n    }, config.onError);\n  }\n\n  return instance;\n}\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Creates request parameters configuration by parsing an existing query object\n * @private\n * @param {Object} query\n * @return {Object} Config object with `params` property, ready to be used in axios\n */\n\n\nfunction createRequestConfig(_ref) {\n  var query = _ref.query;\n  var config = {};\n  delete query.resolveLinks;\n  config.params = copy(query);\n  return config;\n} // eslint-disable-next-line @typescript-eslint/no-explicit-any\n\n\nfunction enforceObjPath(obj, path) {\n  if (!(path in obj)) {\n    var err = new Error();\n    err.name = 'PropertyMissing';\n    err.message = \"Required property \".concat(path, \" missing from:\\n\\n\").concat(JSON.stringify(obj), \"\\n\\n\");\n    throw err;\n  }\n\n  return true;\n} // copied from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze\n\n\nfunction deepFreeze(object) {\n  var propNames = Object.getOwnPropertyNames(object);\n\n  var _iterator = _createForOfIteratorHelper(propNames),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var name = _step.value; // @ts-expect-error\n\n      var value = object[name];\n\n      if (value && _typeof(value) === 'object') {\n        deepFreeze(value);\n      }\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return Object.freeze(object);\n}\n\nfunction freezeSys(obj) {\n  // @ts-expect-error\n  deepFreeze(obj.sys || {});\n  return obj;\n}\n\nfunction getBrowserOS() {\n  var win = getWindow();\n\n  if (!win) {\n    return null;\n  }\n\n  var userAgent = win.navigator.userAgent;\n  var platform = win.navigator.platform;\n  var macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'];\n  var windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'];\n  var iosPlatforms = ['iPhone', 'iPad', 'iPod'];\n  var os = null;\n\n  if (macosPlatforms.indexOf(platform) !== -1) {\n    os = 'macOS';\n  } else if (iosPlatforms.indexOf(platform) !== -1) {\n    os = 'iOS';\n  } else if (windowsPlatforms.indexOf(platform) !== -1) {\n    os = 'Windows';\n  } else if (/Android/.test(userAgent)) {\n    os = 'Android';\n  } else if (/Linux/.test(platform)) {\n    os = 'Linux';\n  }\n\n  return os;\n}\n\nfunction getNodeOS() {\n  var os = platform() || 'linux';\n  var version = release() || '0.0.0';\n  var osMap = {\n    android: 'Android',\n    aix: 'Linux',\n    darwin: 'macOS',\n    freebsd: 'Linux',\n    linux: 'Linux',\n    openbsd: 'Linux',\n    sunos: 'Linux',\n    win32: 'Windows'\n  };\n\n  if (os in osMap) {\n    // @ts-expect-error\n    return \"\".concat(osMap[os] || 'Linux', \"/\").concat(version);\n  }\n\n  return null;\n}\n\nfunction getUserAgentHeader(sdk, application, integration, feature) {\n  var headerParts = [];\n\n  if (application) {\n    headerParts.push(\"app \".concat(application));\n  }\n\n  if (integration) {\n    headerParts.push(\"integration \".concat(integration));\n  }\n\n  if (feature) {\n    headerParts.push('feature ' + feature);\n  }\n\n  headerParts.push(\"sdk \".concat(sdk));\n  var os = null;\n\n  try {\n    if (isReactNative()) {\n      os = getBrowserOS();\n      headerParts.push('platform ReactNative');\n    } else if (isNode()) {\n      os = getNodeOS();\n      headerParts.push(\"platform node.js/\".concat(getNodeVersion()));\n    } else {\n      os = getBrowserOS();\n      headerParts.push('platform browser');\n    }\n  } catch (e) {\n    os = null;\n  }\n\n  if (os) {\n    headerParts.push(\"os \".concat(os));\n  }\n\n  return \"\".concat(headerParts.filter(function (item) {\n    return item !== '';\n  }).join('; '), \";\");\n}\n/**\n * Mixes in a method to return just a plain object with no additional methods\n * @private\n * @param data - Any plain JSON response returned from the API\n * @return Enhanced object with toPlainObject method\n */\n\n\nfunction toPlainObject(data) {\n  return Object.defineProperty(data, 'toPlainObject', {\n    enumerable: false,\n    configurable: false,\n    writable: false,\n    value: function value() {\n      return copy(this);\n    }\n  });\n}\n\nexport { createHttpClient, createRequestConfig, enforceObjPath, freezeSys, getUserAgentHeader, toPlainObject };","map":{"version":3,"sources":["/Users/user/Desktop/tech-store/node_modules/contentful-sdk-core/dist/index.es-modules.js"],"names":["copy","qs","platform","release","_typeof","obj","Symbol","iterator","constructor","prototype","_defineProperty","key","value","Object","defineProperty","enumerable","configurable","writable","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","target","i","arguments","length","source","forEach","getOwnPropertyDescriptors","defineProperties","_slicedToArray","arr","_arrayWithHoles","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","Array","isArray","_arr","_n","_d","_e","undefined","_i","_s","next","done","err","o","minLen","_arrayLikeToArray","n","toString","call","slice","name","from","test","len","arr2","TypeError","_createForOfIteratorHelper","allowArrayLike","it","F","s","e","f","normalCompletion","didErr","step","return","attempts","networkErrorAttempts","noop","delay","ms","Promise","resolve","setTimeout","rateLimit","instance","maxRetry","_instance$defaults","defaults","_instance$defaults$re","responseLogger","_instance$defaults$re2","requestLogger","interceptors","request","use","config","error","reject","response","retryOnError","retryErrorType","wait","Math","pow","SQRT2","status","concat","headers","requestId","floor","random","logHandler","httpAgent","httpsAgent","then","asyncToken","getToken","accessToken","Authorization","isNode","process","browser","isReactNative","window","navigator","product","getNodeVersion","versions","node","version","getWindow","HOST_REGEX","createHttpClient","axios","options","defaultConfig","insecure","level","data","title","message","a","join","console","log","timeout","proxy","basePath","adapter","maxContentLength","missingAccessTokenError","protocol","space","hostname","defaultHostname","port","host","parsed","split","_parsed","Boolean","baseURL","axiosOptions","paramsSerializer","stringify","create","httpClientParams","cloneWithNewParams","newParams","onBeforeRequest","retryLimit","onError","createRequestConfig","_ref","query","resolveLinks","params","enforceObjPath","path","Error","JSON","deepFreeze","propNames","getOwnPropertyNames","_iterator","_step","freeze","freezeSys","sys","getBrowserOS","win","userAgent","macosPlatforms","windowsPlatforms","iosPlatforms","os","indexOf","getNodeOS","osMap","android","aix","darwin","freebsd","linux","openbsd","sunos","win32","getUserAgentHeader","sdk","application","integration","feature","headerParts","item","toPlainObject"],"mappings":"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","sourcesContent":["import copy from 'fast-copy';\nimport qs from 'qs';\nimport { platform, release } from 'os';\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it;\n\n  if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = o[Symbol.iterator]();\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nvar attempts = {};\nvar networkErrorAttempts = 0;\n\nfunction noop() {\n  return undefined;\n}\n\nvar delay = function delay(ms) {\n  return new Promise(function (resolve) {\n    setTimeout(resolve, ms);\n  });\n};\n\nfunction rateLimit(instance) {\n  var maxRetry = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 5;\n  var _instance$defaults = instance.defaults,\n      _instance$defaults$re = _instance$defaults.responseLogger,\n      responseLogger = _instance$defaults$re === void 0 ? noop : _instance$defaults$re,\n      _instance$defaults$re2 = _instance$defaults.requestLogger,\n      requestLogger = _instance$defaults$re2 === void 0 ? noop : _instance$defaults$re2;\n  instance.interceptors.request.use(function (config) {\n    requestLogger(config);\n    return config;\n  }, function (error) {\n    requestLogger(error);\n    return Promise.reject(error);\n  });\n  instance.interceptors.response.use(function (response) {\n    // we don't need to do anything here\n    responseLogger(response);\n    return response;\n  }, function (error) {\n    var response = error.response;\n    var config = error.config;\n    responseLogger(error); // Do not retry if it is disabled or no request config exists (not an axios error)\n\n    if (!config || !instance.defaults.retryOnError) {\n      return Promise.reject(error);\n    }\n\n    var retryErrorType = null;\n    var wait = 0; // Errors without response did not recieve anything from the server\n\n    if (!response) {\n      retryErrorType = 'Connection';\n      networkErrorAttempts++;\n\n      if (networkErrorAttempts > maxRetry) {\n        error.attempts = networkErrorAttempts;\n        return Promise.reject(error);\n      }\n\n      wait = Math.pow(Math.SQRT2, networkErrorAttempts);\n      response = {};\n    } else {\n      networkErrorAttempts = 0;\n    }\n\n    if (response.status >= 500 && response.status < 600) {\n      // 5** errors are server related\n      retryErrorType = \"Server \".concat(response.status);\n      var headers = response.headers || {};\n      var requestId = headers['x-contentful-request-id'] || null;\n      attempts[requestId] = attempts[requestId] || 0;\n      attempts[requestId]++; // we reject if there are too many errors with the same request id or request id is not defined\n\n      if (attempts[requestId] > maxRetry || !requestId) {\n        error.attempts = attempts[requestId];\n        return Promise.reject(error);\n      }\n\n      wait = Math.pow(Math.SQRT2, attempts[requestId]);\n    } else if (response.status === 429) {\n      // 429 errors are exceeded rate limit exceptions\n      retryErrorType = 'Rate limit'; // all headers are lowercased by axios https://github.com/mzabriskie/axios/issues/413\n\n      if (response.headers && error.response.headers['x-contentful-ratelimit-reset']) {\n        wait = response.headers['x-contentful-ratelimit-reset'];\n      }\n    }\n\n    if (retryErrorType) {\n      // convert to ms and add jitter\n      wait = Math.floor(wait * 1000 + Math.random() * 200 + 500);\n      instance.defaults.logHandler('warning', \"\".concat(retryErrorType, \" error occurred. Waiting for \").concat(wait, \" ms before retrying...\"));\n      /* Somehow between the interceptor and retrying the request the httpAgent/httpsAgent gets transformed from an Agent-like object\n       to a regular object, causing failures on retries after rate limits. Removing these properties here fixes the error, but retry\n       requests still use the original http/httpsAgent property */\n\n      delete config.httpAgent;\n      delete config.httpsAgent;\n      return delay(wait).then(function () {\n        return instance(config);\n      });\n    }\n\n    return Promise.reject(error);\n  });\n}\n\nfunction asyncToken(instance, getToken) {\n  instance.interceptors.request.use(function (config) {\n    return getToken().then(function (accessToken) {\n      config.headers = _objectSpread2(_objectSpread2({}, config.headers), {}, {\n        Authorization: \"Bearer \".concat(accessToken)\n      });\n      return config;\n    });\n  });\n}\n\nfunction isNode() {\n  /**\n   * Polyfills of 'process' might set process.browser === true\n   *\n   * See:\n   * https://github.com/webpack/node-libs-browser/blob/master/mock/process.js#L8\n   * https://github.com/defunctzombie/node-process/blob/master/browser.js#L156\n   **/\n  return typeof process !== 'undefined' && !process.browser;\n}\nfunction isReactNative() {\n  return typeof window !== 'undefined' && 'navigator' in window && 'product' in window.navigator && window.navigator.product === 'ReactNative';\n}\nfunction getNodeVersion() {\n  return process.versions && process.versions.node ? \"v\".concat(process.versions.node) : process.version;\n}\nfunction getWindow() {\n  return window;\n}\n\n// Also enforces toplevel domain specified, no spaces and no protocol\n\nvar HOST_REGEX = /^(?!\\w+:\\/\\/)([^\\s:]+\\.?[^\\s:]+)(?::(\\d+))?(?!:)$/;\n/**\n * Create pre configured axios instance\n * @private\n * @param {AxiosStatic} axios - Axios library\n * @param {CreateHttpClientParams} options - Initialization parameters for the HTTP client\n * @return {ContentfulAxiosInstance} Initialized axios instance\n */\n\nfunction createHttpClient(axios, options) {\n  var defaultConfig = {\n    insecure: false,\n    retryOnError: true,\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    logHandler: function logHandler(level, data) {\n      if (level === 'error' && data) {\n        var title = [data.name, data.message].filter(function (a) {\n          return a;\n        }).join(' - ');\n        console.error(\"[error] \".concat(title));\n        console.error(data);\n        return;\n      }\n\n      console.log(\"[\".concat(level, \"] \").concat(data));\n    },\n    // Passed to axios\n    headers: {},\n    httpAgent: false,\n    httpsAgent: false,\n    timeout: 30000,\n    proxy: false,\n    basePath: '',\n    adapter: undefined,\n    maxContentLength: 1073741824 // 1GB\n\n  };\n\n  var config = _objectSpread2(_objectSpread2({}, defaultConfig), options);\n\n  if (!config.accessToken) {\n    var missingAccessTokenError = new TypeError('Expected parameter accessToken');\n    config.logHandler('error', missingAccessTokenError);\n    throw missingAccessTokenError;\n  } // Construct axios baseURL option\n\n\n  var protocol = config.insecure ? 'http' : 'https';\n  var space = config.space ? \"\".concat(config.space, \"/\") : '';\n  var hostname = config.defaultHostname;\n  var port = config.insecure ? 80 : 443;\n\n  if (config.host && HOST_REGEX.test(config.host)) {\n    var parsed = config.host.split(':');\n\n    if (parsed.length === 2) {\n\n      var _parsed = _slicedToArray(parsed, 2);\n\n      hostname = _parsed[0];\n      port = _parsed[1];\n    } else {\n      hostname = parsed[0];\n    }\n  } // Ensure that basePath does start but not end with a slash\n\n\n  if (config.basePath) {\n    config.basePath = \"/\".concat(config.basePath.split('/').filter(Boolean).join('/'));\n  }\n\n  var baseURL = options.baseURL || \"\".concat(protocol, \"://\").concat(hostname, \":\").concat(port).concat(config.basePath, \"/spaces/\").concat(space);\n\n  if (!config.headers.Authorization && typeof config.accessToken !== 'function') {\n    config.headers.Authorization = 'Bearer ' + config.accessToken;\n  } // Set these headers only for node because browsers don't like it when you\n  // override user-agent or accept-encoding.\n  // The SDKs should set their own X-Contentful-User-Agent.\n\n\n  if (isNode()) {\n    config.headers['user-agent'] = 'node.js/' + getNodeVersion();\n    config.headers['Accept-Encoding'] = 'gzip';\n  }\n\n  var axiosOptions = {\n    // Axios\n    baseURL: baseURL,\n    headers: config.headers,\n    httpAgent: config.httpAgent,\n    httpsAgent: config.httpsAgent,\n    paramsSerializer: qs.stringify,\n    proxy: config.proxy,\n    timeout: config.timeout,\n    adapter: config.adapter,\n    maxContentLength: config.maxContentLength,\n    // Contentful\n    logHandler: config.logHandler,\n    responseLogger: config.responseLogger,\n    requestLogger: config.requestLogger,\n    retryOnError: config.retryOnError\n  };\n  var instance = axios.create(axiosOptions);\n  instance.httpClientParams = options;\n  /**\n   * Creates a new axios instance with the same default base parameters as the\n   * current one, and with any overrides passed to the newParams object\n   * This is useful as the SDKs use dependency injection to get the axios library\n   * and the version of the library comes from different places depending\n   * on whether it's a browser build or a node.js build.\n   * @private\n   * @param {CreateHttpClientParams} httpClientParams - Initialization parameters for the HTTP client\n   * @return {ContentfulAxiosInstance} Initialized axios instance\n   */\n\n  instance.cloneWithNewParams = function (newParams) {\n    return createHttpClient(axios, _objectSpread2(_objectSpread2({}, copy(options)), newParams));\n  };\n  /**\n   * Apply interceptors.\n   * Please note that the order of interceptors is important\n   */\n\n\n  if (config.onBeforeRequest) {\n    instance.interceptors.request.use(config.onBeforeRequest);\n  }\n\n  if (typeof config.accessToken === 'function') {\n    asyncToken(instance, config.accessToken);\n  }\n\n  rateLimit(instance, config.retryLimit);\n\n  if (config.onError) {\n    instance.interceptors.response.use(function (response) {\n      return response;\n    }, config.onError);\n  }\n\n  return instance;\n}\n\n/* eslint-disable @typescript-eslint/no-explicit-any */\n\n/**\n * Creates request parameters configuration by parsing an existing query object\n * @private\n * @param {Object} query\n * @return {Object} Config object with `params` property, ready to be used in axios\n */\nfunction createRequestConfig(_ref) {\n  var query = _ref.query;\n  var config = {};\n  delete query.resolveLinks;\n  config.params = copy(query);\n  return config;\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nfunction enforceObjPath(obj, path) {\n  if (!(path in obj)) {\n    var err = new Error();\n    err.name = 'PropertyMissing';\n    err.message = \"Required property \".concat(path, \" missing from:\\n\\n\").concat(JSON.stringify(obj), \"\\n\\n\");\n    throw err;\n  }\n\n  return true;\n}\n\n// copied from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/freeze\nfunction deepFreeze(object) {\n  var propNames = Object.getOwnPropertyNames(object);\n\n  var _iterator = _createForOfIteratorHelper(propNames),\n      _step;\n\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var name = _step.value;\n      // @ts-expect-error\n      var value = object[name];\n\n      if (value && _typeof(value) === 'object') {\n        deepFreeze(value);\n      }\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n\n  return Object.freeze(object);\n}\n\nfunction freezeSys(obj) {\n  // @ts-expect-error\n  deepFreeze(obj.sys || {});\n  return obj;\n}\n\nfunction getBrowserOS() {\n  var win = getWindow();\n\n  if (!win) {\n    return null;\n  }\n\n  var userAgent = win.navigator.userAgent;\n  var platform = win.navigator.platform;\n  var macosPlatforms = ['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'];\n  var windowsPlatforms = ['Win32', 'Win64', 'Windows', 'WinCE'];\n  var iosPlatforms = ['iPhone', 'iPad', 'iPod'];\n  var os = null;\n\n  if (macosPlatforms.indexOf(platform) !== -1) {\n    os = 'macOS';\n  } else if (iosPlatforms.indexOf(platform) !== -1) {\n    os = 'iOS';\n  } else if (windowsPlatforms.indexOf(platform) !== -1) {\n    os = 'Windows';\n  } else if (/Android/.test(userAgent)) {\n    os = 'Android';\n  } else if (/Linux/.test(platform)) {\n    os = 'Linux';\n  }\n\n  return os;\n}\n\nfunction getNodeOS() {\n  var os = platform() || 'linux';\n  var version = release() || '0.0.0';\n  var osMap = {\n    android: 'Android',\n    aix: 'Linux',\n    darwin: 'macOS',\n    freebsd: 'Linux',\n    linux: 'Linux',\n    openbsd: 'Linux',\n    sunos: 'Linux',\n    win32: 'Windows'\n  };\n\n  if (os in osMap) {\n    // @ts-expect-error\n    return \"\".concat(osMap[os] || 'Linux', \"/\").concat(version);\n  }\n\n  return null;\n}\n\nfunction getUserAgentHeader(sdk, application, integration, feature) {\n  var headerParts = [];\n\n  if (application) {\n    headerParts.push(\"app \".concat(application));\n  }\n\n  if (integration) {\n    headerParts.push(\"integration \".concat(integration));\n  }\n\n  if (feature) {\n    headerParts.push('feature ' + feature);\n  }\n\n  headerParts.push(\"sdk \".concat(sdk));\n  var os = null;\n\n  try {\n    if (isReactNative()) {\n      os = getBrowserOS();\n      headerParts.push('platform ReactNative');\n    } else if (isNode()) {\n      os = getNodeOS();\n      headerParts.push(\"platform node.js/\".concat(getNodeVersion()));\n    } else {\n      os = getBrowserOS();\n      headerParts.push('platform browser');\n    }\n  } catch (e) {\n    os = null;\n  }\n\n  if (os) {\n    headerParts.push(\"os \".concat(os));\n  }\n\n  return \"\".concat(headerParts.filter(function (item) {\n    return item !== '';\n  }).join('; '), \";\");\n}\n\n/**\n * Mixes in a method to return just a plain object with no additional methods\n * @private\n * @param data - Any plain JSON response returned from the API\n * @return Enhanced object with toPlainObject method\n */\n\nfunction toPlainObject(data) {\n  return Object.defineProperty(data, 'toPlainObject', {\n    enumerable: false,\n    configurable: false,\n    writable: false,\n    value: function value() {\n      return copy(this);\n    }\n  });\n}\n\nexport { createHttpClient, createRequestConfig, enforceObjPath, freezeSys, getUserAgentHeader, toPlainObject };\n"]},"metadata":{},"sourceType":"module"}