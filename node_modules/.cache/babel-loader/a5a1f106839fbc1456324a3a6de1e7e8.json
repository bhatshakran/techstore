{"ast":null,"code":"import _regeneratorRuntime from \"/Users/user/Desktop/tech-store/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) {\n  try {\n    var info = gen[key](arg);\n    var value = info.value;\n  } catch (error) {\n    reject(error);\n    return;\n  }\n\n  if (info.done) {\n    resolve(value);\n  } else {\n    Promise.resolve(value).then(_next, _throw);\n  }\n}\n\nfunction _asyncToGenerator(fn) {\n  return function () {\n    var self = this,\n        args = arguments;\n    return new Promise(function (resolve, reject) {\n      var gen = fn.apply(self, args);\n\n      function _next(value) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value);\n      }\n\n      function _throw(err) {\n        asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err);\n      }\n\n      _next(undefined);\n    });\n  };\n}\n/**\n * See <a href=\"https://www.contentful.com/developers/docs/concepts/sync/\">Synchronization</a> for more information.\n * @namespace Sync\n */\n\n\nimport { createRequestConfig, freezeSys, toPlainObject } from 'contentful-sdk-core';\nimport resolveResponse from 'contentful-resolve-response';\nimport mixinStringifySafe from './mixins/stringify-safe';\n/**\n * @memberof Sync\n * @typedef SyncCollection\n * @prop {Array<Entities.Entry>} entries - All existing entries on first sync. New and updated entries on subsequent syncs.\n * @prop {Array<Entities.Asset>} assets - All existing assets on first sync. New and updated assets on subsequent syncs.\n * @prop {Array<Sync.DeletedEntry>} deletedEntries - List of deleted Entries since last sync\n * @prop {Array<Sync.DeletedAsset>} deletedAssets - List of deleted Assets since last sync\n * @prop {string} nextSyncToken - Token to be sent to the next sync call\n * @prop {function(): Object} toPlainObject() - Returns this Sync collection as a plain JS object\n * @prop {function(?function=, space=): Object} stringifySafe(replacer,space) - Stringifies the Sync collection, accounting for circular references. Circular references will be replaced with just a Link object, with a <code>circular</code> property set to <code>true</code>. See <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify\">MDN</a> and <a href=\"https://www.npmjs.com/package/json-stringify-safe\">json-stringify-safe</a> for more details on the arguments this method can take.\n */\n\n/**\n * Deleted Entries are the same as Entries, but only appear on the sync API.\n * @memberof Sync\n * @typedef DeletedEntry\n * @type Entities.Entry\n */\n\n/**\n * Deleted Assets are the same as Assets, but only appear on the sync API.\n * @memberof Sync\n * @typedef DeletedAsset\n * @type Entities.Asset\n */\n\n/**\n * This module retrieves all the available pages for a sync operation\n * @private\n * @param {Object} http - HTTP client\n * @param {Object} query - Query object\n * @param {Object} options - Sync options object\n * @param {boolean} [options.resolveLinks = true] - If links should be resolved\n * @param {boolean} [options.removeUnresolved = false] - If unresolvable links should get removed\n * @param {boolean} [options.paginate = true] - If further sync pages should automatically be crawled\n * @return {Promise<SyncCollection>}\n */\n\nexport default function pagedSync(_x, _x2) {\n  return _pagedSync.apply(this, arguments);\n}\n/**\n * @private\n * @param {Array<Entities.Entry|Entities.Array|Sync.DeletedEntry|Sync.DeletedAsset>} items\n * @return {Object} Entities mapped to an object for each entity type\n */\n\nfunction _pagedSync() {\n  _pagedSync = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(http, query) {\n    var options,\n        defaultOptions,\n        _defaultOptions$optio,\n        resolveLinks,\n        removeUnresolved,\n        paginate,\n        syncOptions,\n        response,\n        mappedResponseItems,\n        _args = arguments;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            options = _args.length > 2 && _args[2] !== undefined ? _args[2] : {};\n\n            if (!(!query || !query.initial && !query.nextSyncToken && !query.nextPageToken)) {\n              _context.next = 3;\n              break;\n            }\n\n            throw new Error('Please provide one of `initial`, `nextSyncToken` or `nextPageToken` parameters for syncing');\n\n          case 3:\n            if (!(query && query.content_type && !query.type)) {\n              _context.next = 7;\n              break;\n            }\n\n            query.type = 'Entry';\n            _context.next = 9;\n            break;\n\n          case 7:\n            if (!(query && query.content_type && query.type && query.type !== 'Entry')) {\n              _context.next = 9;\n              break;\n            }\n\n            throw new Error('When using the `content_type` filter your `type` parameter cannot be different from `Entry`.');\n\n          case 9:\n            defaultOptions = {\n              resolveLinks: true,\n              removeUnresolved: false,\n              paginate: true\n            };\n            _defaultOptions$optio = _objectSpread(_objectSpread({}, defaultOptions), options), resolveLinks = _defaultOptions$optio.resolveLinks, removeUnresolved = _defaultOptions$optio.removeUnresolved, paginate = _defaultOptions$optio.paginate;\n            syncOptions = {\n              paginate: paginate\n            };\n            _context.next = 14;\n            return getSyncPage(http, [], query, syncOptions);\n\n          case 14:\n            response = _context.sent; // clones response.items used in includes because we don't want these to be mutated\n\n            if (resolveLinks) {\n              response.items = resolveResponse(response, {\n                removeUnresolved: removeUnresolved,\n                itemEntryPoints: ['fields']\n              });\n            } // maps response items again after getters are attached\n\n\n            mappedResponseItems = mapResponseItems(response.items);\n\n            if (response.nextSyncToken) {\n              mappedResponseItems.nextSyncToken = response.nextSyncToken;\n            }\n\n            if (response.nextPageToken) {\n              mappedResponseItems.nextPageToken = response.nextPageToken;\n            }\n\n            return _context.abrupt(\"return\", freezeSys(mixinStringifySafe(toPlainObject(mappedResponseItems))));\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _pagedSync.apply(this, arguments);\n}\n\nfunction mapResponseItems(items) {\n  var reducer = function reducer(type) {\n    return function (accumulated, item) {\n      if (item.sys.type === type) {\n        accumulated.push(toPlainObject(item));\n      }\n\n      return accumulated;\n    };\n  };\n\n  return {\n    entries: items.reduce(reducer('Entry'), []),\n    assets: items.reduce(reducer('Asset'), []),\n    deletedEntries: items.reduce(reducer('DeletedEntry'), []),\n    deletedAssets: items.reduce(reducer('DeletedAsset'), [])\n  };\n}\n/**\n * If the response contains a nextPageUrl, extracts the sync token to get the\n * next page and calls itself again with that token.\n * Otherwise, if the response contains a nextSyncUrl, extracts the sync token\n * and returns it.\n * On each call of this function, any retrieved items are collected in the\n * supplied items array, which gets returned in the end\n * @private\n * @param {Object} http\n * @param {Array<Entities.Entry|Entities.Array|Sync.DeletedEntry|Sync.DeletedAsset>} items\n * @param {Object} query\n * @param {Object} options - Sync page options object\n * @param {boolean} [options.paginate = true] - If further sync pages should automatically be crawled\n * @return {Promise<{items: Array, nextSyncToken: string}>}\n */\n\n\nfunction getSyncPage(_x3, _x4, _x5, _x6) {\n  return _getSyncPage.apply(this, arguments);\n}\n/**\n * Extracts token out of an url\n * @private\n */\n\n\nfunction _getSyncPage() {\n  _getSyncPage = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(http, items, query, _ref) {\n    var paginate, response, data;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            paginate = _ref.paginate;\n\n            if (query.nextSyncToken) {\n              query.sync_token = query.nextSyncToken;\n              delete query.nextSyncToken;\n            }\n\n            if (query.nextPageToken) {\n              query.sync_token = query.nextPageToken;\n              delete query.nextPageToken;\n            }\n\n            if (query.sync_token) {\n              delete query.initial;\n              delete query.type;\n              delete query.content_type;\n              delete query.limit;\n            }\n\n            _context2.next = 6;\n            return http.get('sync', createRequestConfig({\n              query: query\n            }));\n\n          case 6:\n            response = _context2.sent;\n            data = response.data || {};\n            items = items.concat(data.items || []);\n\n            if (!data.nextPageUrl) {\n              _context2.next = 17;\n              break;\n            }\n\n            if (!paginate) {\n              _context2.next = 14;\n              break;\n            }\n\n            delete query.initial;\n            query.sync_token = getToken(data.nextPageUrl);\n            return _context2.abrupt(\"return\", getSyncPage(http, items, query, {\n              paginate: paginate\n            }));\n\n          case 14:\n            return _context2.abrupt(\"return\", {\n              items: items,\n              nextPageToken: getToken(data.nextPageUrl)\n            });\n\n          case 17:\n            if (!data.nextSyncUrl) {\n              _context2.next = 21;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", {\n              items: items,\n              nextSyncToken: getToken(data.nextSyncUrl)\n            });\n\n          case 21:\n            return _context2.abrupt(\"return\", {\n              items: []\n            });\n\n          case 22:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _getSyncPage.apply(this, arguments);\n}\n\nfunction getToken(url) {\n  var urlParts = url.split('?');\n  return urlParts.length > 0 ? urlParts[1].replace('sync_token=', '') : '';\n}","map":{"version":3,"sources":["/Users/user/Desktop/tech-store/node_modules/contentful/dist/es-modules/paged-sync.js"],"names":["ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","asyncGeneratorStep","gen","resolve","reject","_next","_throw","arg","info","error","done","Promise","then","_asyncToGenerator","fn","self","args","err","undefined","createRequestConfig","freezeSys","toPlainObject","resolveResponse","mixinStringifySafe","pagedSync","_x","_x2","_pagedSync","mark","_callee","http","query","options","defaultOptions","_defaultOptions$optio","resolveLinks","removeUnresolved","paginate","syncOptions","response","mappedResponseItems","_args","wrap","_callee$","_context","prev","next","initial","nextSyncToken","nextPageToken","Error","content_type","type","getSyncPage","sent","items","itemEntryPoints","mapResponseItems","abrupt","stop","reducer","accumulated","item","sys","entries","reduce","assets","deletedEntries","deletedAssets","_x3","_x4","_x5","_x6","_getSyncPage","_callee2","_ref","data","_callee2$","_context2","sync_token","limit","get","concat","nextPageUrl","getToken","nextSyncUrl","url","urlParts","split","replace"],"mappings":"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","sourcesContent":["function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\n/**\n * See <a href=\"https://www.contentful.com/developers/docs/concepts/sync/\">Synchronization</a> for more information.\n * @namespace Sync\n */\nimport { createRequestConfig, freezeSys, toPlainObject } from 'contentful-sdk-core';\nimport resolveResponse from 'contentful-resolve-response';\nimport mixinStringifySafe from './mixins/stringify-safe';\n/**\n * @memberof Sync\n * @typedef SyncCollection\n * @prop {Array<Entities.Entry>} entries - All existing entries on first sync. New and updated entries on subsequent syncs.\n * @prop {Array<Entities.Asset>} assets - All existing assets on first sync. New and updated assets on subsequent syncs.\n * @prop {Array<Sync.DeletedEntry>} deletedEntries - List of deleted Entries since last sync\n * @prop {Array<Sync.DeletedAsset>} deletedAssets - List of deleted Assets since last sync\n * @prop {string} nextSyncToken - Token to be sent to the next sync call\n * @prop {function(): Object} toPlainObject() - Returns this Sync collection as a plain JS object\n * @prop {function(?function=, space=): Object} stringifySafe(replacer,space) - Stringifies the Sync collection, accounting for circular references. Circular references will be replaced with just a Link object, with a <code>circular</code> property set to <code>true</code>. See <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify\">MDN</a> and <a href=\"https://www.npmjs.com/package/json-stringify-safe\">json-stringify-safe</a> for more details on the arguments this method can take.\n */\n\n/**\n * Deleted Entries are the same as Entries, but only appear on the sync API.\n * @memberof Sync\n * @typedef DeletedEntry\n * @type Entities.Entry\n */\n\n/**\n * Deleted Assets are the same as Assets, but only appear on the sync API.\n * @memberof Sync\n * @typedef DeletedAsset\n * @type Entities.Asset\n */\n\n/**\n * This module retrieves all the available pages for a sync operation\n * @private\n * @param {Object} http - HTTP client\n * @param {Object} query - Query object\n * @param {Object} options - Sync options object\n * @param {boolean} [options.resolveLinks = true] - If links should be resolved\n * @param {boolean} [options.removeUnresolved = false] - If unresolvable links should get removed\n * @param {boolean} [options.paginate = true] - If further sync pages should automatically be crawled\n * @return {Promise<SyncCollection>}\n */\n\nexport default function pagedSync(_x, _x2) {\n  return _pagedSync.apply(this, arguments);\n}\n/**\n * @private\n * @param {Array<Entities.Entry|Entities.Array|Sync.DeletedEntry|Sync.DeletedAsset>} items\n * @return {Object} Entities mapped to an object for each entity type\n */\n\nfunction _pagedSync() {\n  _pagedSync = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(http, query) {\n    var options,\n        defaultOptions,\n        _defaultOptions$optio,\n        resolveLinks,\n        removeUnresolved,\n        paginate,\n        syncOptions,\n        response,\n        mappedResponseItems,\n        _args = arguments;\n\n    return regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            options = _args.length > 2 && _args[2] !== undefined ? _args[2] : {};\n\n            if (!(!query || !query.initial && !query.nextSyncToken && !query.nextPageToken)) {\n              _context.next = 3;\n              break;\n            }\n\n            throw new Error('Please provide one of `initial`, `nextSyncToken` or `nextPageToken` parameters for syncing');\n\n          case 3:\n            if (!(query && query.content_type && !query.type)) {\n              _context.next = 7;\n              break;\n            }\n\n            query.type = 'Entry';\n            _context.next = 9;\n            break;\n\n          case 7:\n            if (!(query && query.content_type && query.type && query.type !== 'Entry')) {\n              _context.next = 9;\n              break;\n            }\n\n            throw new Error('When using the `content_type` filter your `type` parameter cannot be different from `Entry`.');\n\n          case 9:\n            defaultOptions = {\n              resolveLinks: true,\n              removeUnresolved: false,\n              paginate: true\n            };\n            _defaultOptions$optio = _objectSpread(_objectSpread({}, defaultOptions), options), resolveLinks = _defaultOptions$optio.resolveLinks, removeUnresolved = _defaultOptions$optio.removeUnresolved, paginate = _defaultOptions$optio.paginate;\n            syncOptions = {\n              paginate: paginate\n            };\n            _context.next = 14;\n            return getSyncPage(http, [], query, syncOptions);\n\n          case 14:\n            response = _context.sent;\n\n            // clones response.items used in includes because we don't want these to be mutated\n            if (resolveLinks) {\n              response.items = resolveResponse(response, {\n                removeUnresolved: removeUnresolved,\n                itemEntryPoints: ['fields']\n              });\n            } // maps response items again after getters are attached\n\n\n            mappedResponseItems = mapResponseItems(response.items);\n\n            if (response.nextSyncToken) {\n              mappedResponseItems.nextSyncToken = response.nextSyncToken;\n            }\n\n            if (response.nextPageToken) {\n              mappedResponseItems.nextPageToken = response.nextPageToken;\n            }\n\n            return _context.abrupt(\"return\", freezeSys(mixinStringifySafe(toPlainObject(mappedResponseItems))));\n\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _pagedSync.apply(this, arguments);\n}\n\nfunction mapResponseItems(items) {\n  var reducer = function reducer(type) {\n    return function (accumulated, item) {\n      if (item.sys.type === type) {\n        accumulated.push(toPlainObject(item));\n      }\n\n      return accumulated;\n    };\n  };\n\n  return {\n    entries: items.reduce(reducer('Entry'), []),\n    assets: items.reduce(reducer('Asset'), []),\n    deletedEntries: items.reduce(reducer('DeletedEntry'), []),\n    deletedAssets: items.reduce(reducer('DeletedAsset'), [])\n  };\n}\n/**\n * If the response contains a nextPageUrl, extracts the sync token to get the\n * next page and calls itself again with that token.\n * Otherwise, if the response contains a nextSyncUrl, extracts the sync token\n * and returns it.\n * On each call of this function, any retrieved items are collected in the\n * supplied items array, which gets returned in the end\n * @private\n * @param {Object} http\n * @param {Array<Entities.Entry|Entities.Array|Sync.DeletedEntry|Sync.DeletedAsset>} items\n * @param {Object} query\n * @param {Object} options - Sync page options object\n * @param {boolean} [options.paginate = true] - If further sync pages should automatically be crawled\n * @return {Promise<{items: Array, nextSyncToken: string}>}\n */\n\n\nfunction getSyncPage(_x3, _x4, _x5, _x6) {\n  return _getSyncPage.apply(this, arguments);\n}\n/**\n * Extracts token out of an url\n * @private\n */\n\n\nfunction _getSyncPage() {\n  _getSyncPage = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(http, items, query, _ref) {\n    var paginate, response, data;\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            paginate = _ref.paginate;\n\n            if (query.nextSyncToken) {\n              query.sync_token = query.nextSyncToken;\n              delete query.nextSyncToken;\n            }\n\n            if (query.nextPageToken) {\n              query.sync_token = query.nextPageToken;\n              delete query.nextPageToken;\n            }\n\n            if (query.sync_token) {\n              delete query.initial;\n              delete query.type;\n              delete query.content_type;\n              delete query.limit;\n            }\n\n            _context2.next = 6;\n            return http.get('sync', createRequestConfig({\n              query: query\n            }));\n\n          case 6:\n            response = _context2.sent;\n            data = response.data || {};\n            items = items.concat(data.items || []);\n\n            if (!data.nextPageUrl) {\n              _context2.next = 17;\n              break;\n            }\n\n            if (!paginate) {\n              _context2.next = 14;\n              break;\n            }\n\n            delete query.initial;\n            query.sync_token = getToken(data.nextPageUrl);\n            return _context2.abrupt(\"return\", getSyncPage(http, items, query, {\n              paginate: paginate\n            }));\n\n          case 14:\n            return _context2.abrupt(\"return\", {\n              items: items,\n              nextPageToken: getToken(data.nextPageUrl)\n            });\n\n          case 17:\n            if (!data.nextSyncUrl) {\n              _context2.next = 21;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", {\n              items: items,\n              nextSyncToken: getToken(data.nextSyncUrl)\n            });\n\n          case 21:\n            return _context2.abrupt(\"return\", {\n              items: []\n            });\n\n          case 22:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _getSyncPage.apply(this, arguments);\n}\n\nfunction getToken(url) {\n  var urlParts = url.split('?');\n  return urlParts.length > 0 ? urlParts[1].replace('sync_token=', '') : '';\n}"]},"metadata":{},"sourceType":"module"}